<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Bootstrapping Key Infrastructure over EAP</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Terminology">
<link href="#rfc.section.2" rel="Chapter" title="2 TEAP BRSKI Architecture">
<link href="#rfc.section.3" rel="Chapter" title="3 BRSKI Bootstrap and Enroll Operation">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Executing BRSKI in a TEAP Tunnel">
<link href="#rfc.section.4" rel="Chapter" title="4 PKI Certificate Considerations">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 TEAP Tunnel Establishment">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 BRSKI Trust Establishment">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Certificate Expiration Times">
<link href="#rfc.section.5" rel="Chapter" title="5 Channel and Crypto Binding">
<link href="#rfc.section.6" rel="Chapter" title="6 Protocol Flows">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 TEAP Server Grants Access">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 TEAP Server Instructs Client to Perform BRSKI Flow">
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 TEAP Server Instructs Client to Reenroll">
<link href="#rfc.section.6.4" rel="Chapter" title="6.4 Out of Band Reenroll">
<link href="#rfc.section.7" rel="Chapter" title="7 TEAP TLV Formats">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 BRSKI TLVs">
<link href="#rfc.section.7.1.1" rel="Chapter" title="7.1.1 BRSKI-RequestVoucher TLV">
<link href="#rfc.section.7.1.2" rel="Chapter" title="7.1.2 BRSKI-Voucher TLV">
<link href="#rfc.section.7.1.3" rel="Chapter" title="7.1.3 CSR-Attributes TLV">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 Existing TEAP TLV Specifications">
<link href="#rfc.section.7.2.1" rel="Chapter" title="7.2.1 PKCS#10 TLV">
<link href="#rfc.section.7.3" rel="Chapter" title="7.3 TLV Rules">
<link href="#rfc.section.8" rel="Chapter" title="8 Fragmentation">
<link href="#rfc.section.9" rel="Chapter" title="9 IANA Considerations">
<link href="#rfc.section.10" rel="Chapter" title="10 Security Considerations">
<link href="#rfc.section.10.1" rel="Chapter" title="10.1 Issues with Provisionally Authenticated TEAP">
<link href="#rfc.section.10.2" rel="Chapter" title="10.2 Attack Against Discovery">
<link href="#rfc.section.10.3" rel="Chapter" title="10.3 TEAP Server as Registration Authority">
<link href="#rfc.section.10.4" rel="Chapter" title="10.4 Trust of Registrar">
<link href="#rfc.section.11" rel="Chapter" title="11 Acknowledgments">
<link href="#rfc.references" rel="Chapter" title="12 Normative References">
<link href="#rfc.appendix.A" rel="Chapter" title="A Changes from Earlier Versions">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.9.6 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Lear, E., Friel, O., Cam-Winget, N., and D. Harkins" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-lear-eap-teap-brski-03" />
  <meta name="dct.issued" scheme="ISO8601" content="2019-06-28" />
  <meta name="dct.abstract" content="In certain environments, in order for a device to establish any layer three communications, it is necessary for that device to be properly credentialed.  This is a relatively easy problem to solve when a device is associated with a human being and has both input and display functions.  It is less easy when the human, input, and display functions are not present.  To address this case, this memo specifies extensions to the Tunnel Extensible Authentication Protocol (TEAP) method that leverages Bootstrapping Remote Secure Key Infrastructures (BRSKI) in order to provide a credential to a device at layer two.  The basis of this work is that a manufacturer will introduce the device and the local deployment through cryptographic means.  In this sense the same trust model as BRSKI is used." />
  <meta name="description" content="In certain environments, in order for a device to establish any layer three communications, it is necessary for that device to be properly credentialed.  This is a relatively easy problem to solve when a device is associated with a human being and has both input and display functions.  It is less easy when the human, input, and display functions are not present.  To address this case, this memo specifies extensions to the Tunnel Extensible Authentication Protocol (TEAP) method that leverages Bootstrapping Remote Secure Key Infrastructures (BRSKI) in order to provide a credential to a device at layer two.  The basis of this work is that a manufacturer will introduce the device and the local deployment through cryptographic means.  In this sense the same trust model as BRSKI is used." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">E. Lear</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">O. Friel</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">N. Cam-Winget</td>
</tr>
<tr>
<td class="left">Expires: December 30, 2019</td>
<td class="right">Cisco Systems</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">D. Harkins</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">HP Enterprise</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">June 28, 2019</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Bootstrapping Key Infrastructure over EAP<br />
  <span class="filename">draft-lear-eap-teap-brski-03</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>In certain environments, in order for a device to establish any layer three communications, it is necessary for that device to be properly credentialed.  This is a relatively easy problem to solve when a device is associated with a human being and has both input and display functions.  It is less easy when the human, input, and display functions are not present.  To address this case, this memo specifies extensions to the Tunnel Extensible Authentication Protocol (TEAP) method that leverages Bootstrapping Remote Secure Key Infrastructures (BRSKI) in order to provide a credential to a device at layer two.  The basis of this work is that a manufacturer will introduce the device and the local deployment through cryptographic means.  In this sense the same trust model as BRSKI is used.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on December 30, 2019.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2019 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Terminology</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">TEAP BRSKI Architecture</a>
</li>
<li>3.   <a href="#rfc.section.3">BRSKI Bootstrap and Enroll Operation</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">Executing BRSKI in a TEAP Tunnel</a>
</li>
</ul><li>4.   <a href="#rfc.section.4">PKI Certificate Considerations</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">TEAP Tunnel Establishment</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">BRSKI Trust Establishment</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Certificate Expiration Times</a>
</li>
</ul><li>5.   <a href="#rfc.section.5">Channel and Crypto Binding</a>
</li>
<li>6.   <a href="#rfc.section.6">Protocol Flows</a>
</li>
<ul><li>6.1.   <a href="#rfc.section.6.1">TEAP Server Grants Access</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">TEAP Server Instructs Client to Perform BRSKI Flow</a>
</li>
<li>6.3.   <a href="#rfc.section.6.3">TEAP Server Instructs Client to Reenroll</a>
</li>
<li>6.4.   <a href="#rfc.section.6.4">Out of Band Reenroll</a>
</li>
</ul><li>7.   <a href="#rfc.section.7">TEAP TLV Formats</a>
</li>
<ul><li>7.1.   <a href="#rfc.section.7.1">BRSKI TLVs</a>
</li>
<ul><li>7.1.1.   <a href="#rfc.section.7.1.1">BRSKI-RequestVoucher TLV</a>
</li>
<li>7.1.2.   <a href="#rfc.section.7.1.2">BRSKI-Voucher TLV</a>
</li>
<li>7.1.3.   <a href="#rfc.section.7.1.3">CSR-Attributes TLV</a>
</li>
</ul><li>7.2.   <a href="#rfc.section.7.2">Existing TEAP TLV Specifications</a>
</li>
<ul><li>7.2.1.   <a href="#rfc.section.7.2.1">PKCS#10 TLV</a>
</li>
</ul><li>7.3.   <a href="#rfc.section.7.3">TLV Rules</a>
</li>
</ul><li>8.   <a href="#rfc.section.8">Fragmentation</a>
</li>
<li>9.   <a href="#rfc.section.9">IANA Considerations</a>
</li>
<li>10.   <a href="#rfc.section.10">Security Considerations</a>
</li>
<ul><li>10.1.   <a href="#rfc.section.10.1">Issues with Provisionally Authenticated TEAP</a>
</li>
<li>10.2.   <a href="#rfc.section.10.2">Attack Against Discovery</a>
</li>
<li>10.3.   <a href="#rfc.section.10.3">TEAP Server as Registration Authority</a>
</li>
<li>10.4.   <a href="#rfc.section.10.4">Trust of Registrar</a>
</li>
</ul><li>11.   <a href="#rfc.section.11">Acknowledgments</a>
</li>
<li>12.   <a href="#rfc.references">Normative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.A">Changes from Earlier Versions</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p><a href="#I-D.ietf-anima-bootstrapping-keyinfra" class="xref">[I-D.ietf-anima-bootstrapping-keyinfra]</a> (BRSKI) specifies a means to provision credentials to be used as credentials to operationally access networks.  It was designed as a standalone means where some limited access to an IP network is already available.  This is not always the case.  For example, IEEE 802.11 networks generally require authentication prior to any form of address assignment.  While it is possible to assign an IP address to a device on some form of an open network, or to accept some sort of default credential to establish initial IP connectivity, the steps that would then follow might well require that the device is placed on a new network, requiring reseting all layer three parameters.</p>
<p id="rfc.section.1.p.2">A more  natural approach  in such  cases is to  more tightly  bind the provisioning  of credentials with  the authentication  mechanism.  One such way  to do this is  to make use of  the Extensible Authentication Protocol (EAP)  <a href="#RFC3748" class="xref">[RFC3748]</a> and the  Tunnel Extensible Authentication Protocol  (TEAP)  method  <a href="#RFC7170" class="xref">[RFC7170]</a>.    Thus  we  define  new  TEAP Type-Length-Value  (TLV) objects  that can  be used  to  transport the BRSKI protocol messages within the context of a TEAP TLS tunnel.</p>
<p><a href="#RFC7170" class="xref">[RFC7170]</a> discusses the notion of provisioning peers.  Several different mechanisms are available.  Section 3.8 of that document acknowledges the concept of not initially authenticating the outer TLS session so that provisioning may occur.  In addition, exchange of multiple TLV messages between client and EAP server permits multiple provisioning steps.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#terminology" id="terminology">Terminology</a>
</h1>
<p id="rfc.section.1.1.p.1">The reader is presumed to be familiar with EAP terminology as stated in <a href="#RFC3748" class="xref">[RFC3748]</a>.  In addition, the following terms are commonly used in this document.</p>
<p></p>

<ul>
<li>BRSKI: Bootstrapping Remote Secure Key Infrastructures, as defined in <a href="#I-D.ietf-anima-bootstrapping-keyinfra" class="xref">[I-D.ietf-anima-bootstrapping-keyinfra]</a>.  The term is also used to refer to the flow described in that document.</li>
<li>EST: Enrollment over Secure Transport, as defined in <a href="#RFC7030" class="xref">[RFC7030]</a>.</li>
<li>Voucher: a signed JSON object as defined in <a href="#RFC8366" class="xref">[RFC8366]</a>.</li>
</ul>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#arch" id="arch">TEAP BRSKI Architecture</a>
</h1>
<p id="rfc.section.2.p.1">The TEAP BRSKI architecture is illustrated in <a href="#brski-architecture" class="xref">Section 3</a>. The device talks to the TEAP server via the Authenticator using any compliant transport such as <a href="#IEEE8021X" class="xref">[IEEE8021X]</a>.  The architecture illustrated shows an Authenticator distinct from the TEAP server. This is a deployment optimization and when so deployed the communication between Authenticator and TEAP server is a AAA protocol such as RADIUS or DIAMETER.</p>
<p id="rfc.section.2.p.2">The architecture illustrated shows a co-located TEAP server and BRSKI registrar. Not only are these two functions co-located, they MUST be the same entity. This ensures that the entity identified in the device&#8217;s voucher request (the TEAP server) is the same entity that signs the voucher request (the registrar).</p>
<p id="rfc.section.2.p.3">The registrar communicates with the BRSKI MASA service for the purposes of getting signed vouchers. [[TODO: I guess we should mention TEAP server talking to vendor default registrar in the cloud]]</p>
<p id="rfc.section.2.p.4">The registrar also comunicates with a Certificate Authority in order to issue LDevIDs. The architecture shows the registrar and CA as being two logically separate entities, however the CA may be integrated into the registrar. The device is not explicitly aware of whether the CA and registrar functions are integrated.</p>
<pre>
+--------+     +---------+     +---------+     +------+
|        |     |         |     |  TEAP   |&lt;---&gt;| MASA |
|        |     | Authen- |     | server  |     +------+
| Device |&lt;---&gt;| ticator |&lt;---&gt;|         |
|        |     |         |     |  BRSKI  |     +------+
|        |     |         |     |Registrar|&lt;---&gt;|  CA  |
+--------+     +---------+     +---------+     +------+

</pre>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#brski-architecture" id="brski-architecture">BRSKI Bootstrap and Enroll Operation</a>
</h1>
<p id="rfc.section.3.p.1">This section summarises the current BRSKI operation. The BRSKI flow assumes the device has an IDevID and has a manufacturer installed trust anchor that can be used to validate the BRSKI voucher. The BRSKI flow compromises serveral main steps from the perspective of the device:</p>
<p></p>

<ul>
<li>Step 1: Device discovers the registrar</li>
<li>Step 2: Device establishes provisional TLS connection to registrar</li>
<li>Step 3: Device sends voucher request message and receives signed voucher response</li>
<li>Step 4: Device validates voucher and validates provisional TLS connection to registrar</li>
<li>Step 5: Device downloads additional local domain CA information</li>
<li>Step 6: Device downloads Certificate Signing Reqeust (CSR) attributes</li>
<li>Step 7: Device does a certificate enroll to obtain an LDevID</li>
<li>Step 8: Device periodically reenrolls via EST to refresh its LDevID</li>
</ul>
<p id="rfc.section.3.p.3">Most of the operational steps require the device, and thus its internal state machine, to automatically complete the next step without being explicitly instructed to do so by the registrar. For example, the registrar does not explicitly tell the device to download additional local domain CA information, or to do an EST enroll to obtain an LDevID.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#bint" id="bint">Executing BRSKI in a TEAP Tunnel</a>
</h1>
<p id="rfc.section.3.1.p.1">This section outlines how the main BRSKI steps outlined above map to TEAP, and how BRSKI and enrollment can be accomplished inside a TEAP TLS tunnel. The following new TEAP TLVs are introduced:</p>
<p></p>

<ul>
<li>BRSKI-VoucherRequest</li>
<li>BRSKI-Voucher</li>
<li>CSR-Attributes</li>
</ul>
<p id="rfc.section.3.1.p.3">The following steps outline how the above BRSKI flow maps to TEAP.</p>
<p></p>

<ul><li>Step 1: Device discovers the registrar</li></ul>
<p id="rfc.section.3.1.p.5">When BRSKI is executed in a TEAP tunnel, the device exchanges BRSKI TLVs with the TEAP server. The discovery process for devices is therefore the standard wired or wireless LAN EAP server discovery process. The discovery processes outlined in section 4 of <a href="#I-D.ietf-anima-bootstrapping-keyinfra" class="xref">[I-D.ietf-anima-bootstrapping-keyinfra]</a> are not required for initial discovery of the registrar.</p>
<p></p>

<ul><li>Step 2: Device establishes provisional TLS connection to registrar</li></ul>
<p id="rfc.section.3.1.p.7">The device establishes an outer TEAP tunnel with the TEAP server and does not validate the server certificate.  The device presents its LDevID as its identity certificate if it has a valid LDevID, otherwise it presents its IDevID. The TEAP server validates the device&#8217;s certificate using its implicit or explicit trust anchor database. If the device presents an IDevID it is verified against a database of trusted manufacturer certificates. Server policy may also be used to control which certificate the device is allowed present, as described in section {pki-certificate-authority-considerations}.</p>
<p id="rfc.section.3.1.p.8">If the presented credential is sufficient to grant access, the TEAP server can return a TEAP Result TLV indicating success immediately. The device may still send a Request-Action TLV including a BRSKI-VoucherRequest TLV in response to the TEAP Result TLV if it does not have, but requires, provisioning of trust anchors for validating the TEAP server certificate. Note that no inner EAP method is required for this, only an exchange of TEAP TLVs.</p>
<p id="rfc.section.3.1.p.9">[todo] Question: as the device wants the server to reply with a BRSKI-Voucher TLV, does it really send a Request-Action TLV containing a BRSKI-VoucherRequest TLV, or does it send a Request-Action TLV containing a BRSKI-Voucher TLV?? The TEAP draft is a bit ambiguous here. Normally, if one end sends a Request-Action including XXX-TLV, it means it wants the far end ot send an XXX-TLV&#8230;</p>
<p id="rfc.section.3.1.p.10">[todo] Question: general TEAP protocol question: does the device have to send a Request-Action w/BRSKI-VoucherRequest or can it send a BRSKI-VoucherRequest on its own? I&#8217;m not clear on this.</p>
<p id="rfc.section.3.1.p.11">If the TEAP server requires that the device execute a BRSKI flow, the server sends a Request-Action TLV that includes a BRSKI-VoucherRequest TLV. For example, if the device presented its IDevID but the TEAP server requires an LDevID.</p>
<p id="rfc.section.3.1.p.12">[todo] Question: to nit pick, the server should send a Request-Action TLV including a PKCS#10 TLV to tell the client to enroll. How does the server really know that the client has the correct trust established (as previously received by a BRSKI-Voucher)? If the client sends an IDevID, does server always send a Request-Action including both BRSKI-VoucherRequest and PKCS#10 TLVs? Whats the client behaviour? I assume client can spontaneously send BRSKI-VoucherRequest and/or PCSK#10 without being explicitly instructed to. Just need to get the language correct here.</p>
<p id="rfc.section.3.1.p.13">The TEAP server may also require the device to reenroll, for example, if the device presented a valid LDevID that is very closed to expiration. The server may instruct a device to reenroll by sending a Request-Action TLV that includes a zero byte length PKCS#10 TLV.</p>
<p></p>

<ul><li>Step 3: Device sends voucher request message and receives signed voucher response</li></ul>
<p id="rfc.section.3.1.p.15">The device sends a BRSKI-RequestVoucher TLV to the TEAP server. The TEAP server forwards the RequestVoucher message to the MASA server, and the MASA server replies with a signed voucher. The TEAP server sends a BRSKI-Voucher TLV to the device.</p>
<p id="rfc.section.3.1.p.16">If the MASA server does not issue a signed voucher, the TEAP server sends an EAP-Error TLV with a suitable error code to the device.</p>
<p id="rfc.section.3.1.p.17">For wireless devices in particular, it is important that the MASA server only return a voucher for devices known to be associated with a particular registrar.  In this sense, success indicates that the device is on the correct network, while failure indicates the device should try to provision itself within wireless networks (e.g, go to the next SSID).</p>
<p></p>

<ul><li>Step 4: Device validates voucher and validates provisional TLS connection to registrar</li></ul>
<p id="rfc.section.3.1.p.19">The device validates the signed voucher using its manufacturer installed trust anchor, and uses the CA information in the voucher to validate the TLS connection to the TEAP server.</p>
<p id="rfc.section.3.1.p.20">If the device fails to validate the voucher, then it sends a TEAP-Error TLV indicating failiure to the TEAP server.</p>
<p id="rfc.section.3.1.p.21">Similarly, if the device validates the voucher, but fails to validate the provisional TLS connection, then it sends a TEAP-Error TLV indicating failure to the TEAP server. Note that the outer TLS tunnel has already been established, thus allowing the client to send a TEAP-Error TLV to the server inside that tunnel to indicate that it failed to verify the provisionally accepted outer TLS tunnel server identity.</p>
<p></p>

<ul><li>Step 5: Device downloads additional local domain CA information</li></ul>
<p id="rfc.section.3.1.p.23">On completion of the BRSKI flow, the device SHOULD send a Trusted-Server-Root TLV to the TEAP server in order to discover additional local domain CAs. This is equivalent to section [todo] from <a href="#I-D.ietf-anima-bootstrapping-keyinfra" class="xref">[I-D.ietf-anima-bootstrapping-keyinfra]</a>.</p>
<p></p>

<ul><li>Step 6: Device downloads CSR attributes</li></ul>
<p id="rfc.section.3.1.p.25">No later than the completion of step 5, server MUST send a CSR-Attributes TLV to peer server in order to discover the correct fields to include when it enrolls to get an LDevID.</p>
<p></p>

<ul><li>Step 7: Device does a certificate enroll to obtain an LDevID</li></ul>
<p id="rfc.section.3.1.p.27">When executing the BRSKI flow inside a TEAP tunnel, the device does not directly leverage EST when doing its initial enroll. Instead, the device uses the existing TEAP PKCS#10 and PCKS#7 TEAP mechanisms.</p>
<p id="rfc.section.3.1.p.28">Once the BRSKI flow is complete, the device can now send a PKCS#10 TLV to enroll and request an LDevID. If the TEAP server instructed the device to start the BRSKI flow via a Request-Action TLV that includes a BRSKI-RequestVoucher TLV, then the device MUST send a PKCS#10 in order to start the enroll process. The TEAP server will handle the PKCS#10 and ultimately return a PKCS#7 including an LDevID to the device.</p>
<p id="rfc.section.3.1.p.29">If the TEAP server granted the device access on completion of the outer TEAP TLS tunnel in step 2 without sending a Request-Action TLV, the device does not have to send a PKCS#10 to enroll.</p>
<p id="rfc.section.3.1.p.30">At this point, the device is said to be provisioned for local network access, and may authenticate in the future via 802.1X with its newly acquired credentials.</p>
<p></p>

<ul><li>Step 8: Device periodically reenrolls to refresh its LDevID</li></ul>
<p id="rfc.section.3.1.p.32">When a device&#8217;s LDevID is close to expiration, there are two options for re-enrollment in order to obtain a fresh LDevID. As outlined in Step 2 above, the TEAP server may instruct the device to reenroll by sending a Request-Action TLV including a PKCS#10 TLV. If the TEAP server explicilty instructs the device to reenroll via these TLV exchange, then the device MUST send a PKCS#10 to reenroll and request a fresh LDevID.</p>
<p id="rfc.section.3.1.p.33">However, the device SHOULD reenroll if it determines that its LDevID is close to expiration without waiting for explicit instruction from the TEAP server. There are two options to do this.</p>
<p id="rfc.section.3.1.p.34">Option 1: The device reenrolls for a new LDevID directly with the EST CA outside the context of the 802.1X TEAP flow. The device uses the registrar discovery mechanisms oulined in <a href="#I-D.ietf-anima-bootstrapping-keyinfra" class="xref">[I-D.ietf-anima-bootstrapping-keyinfra]</a> to discover the registrar and the device sends the EST reenroll messages to the discovered registrar endpoint. No new TEAP TLVs are defined to facilitate discover of the registrar or EST endpoints inside the context of the TEAP tunnel.</p>
<p id="rfc.section.3.1.p.35">Option 2: When the device is performing a periodic 802.1X authentication using its current LDevID, it reenrolls for a new LDevID by sending a PKCS#10 TLV inside the TEAP TLS tunnel.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#pki-certificate-considerations" id="pki-certificate-considerations">PKI Certificate Considerations</a>
</h1>
<p id="rfc.section.4.p.1">Careful consideration must be given to PKI certificate authority handling when:</p>
<p></p>

<ul>
<li>Establishing the TEAP tunnel</li>
<li>Establishing trust using BRSKI</li>
</ul>
<p id="rfc.section.4.p.3">Additionally, consideration must be given to IDevID and LDevID expiration times.</p>
<p id="rfc.section.4.p.4">These are described in more detail here.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#teap-tunnel-establishment" id="teap-tunnel-establishment">TEAP Tunnel Establishment</a>
</h1>
<p id="rfc.section.4.1.p.1">Because this method establishes a client identity, and for purposes of partioning of responsibility, the peer uses a generic identity string of teap-brsk@TBD1 as its network access identifier (NAI).</p>
<p id="rfc.section.4.1.p.2">The client sends its ClientHello to initiate TLS tunnel establishment. It is possible for the TEAP server to restrict the certificates that the client can use for tunnel establishment by including a list of CA distinguished names in the certificate_authorities field in the CertificateRequest message. Network operators may want to do this in order to restrict network access to clients that have a certificate signed by one of a small set of trusted manufacturer/supplier CAs. If the client has both an IDevID and an LDevID, the client should present the LDevID in preference to its IDevID if allowed by server policy.</p>
<p id="rfc.section.4.1.p.3">In practice, network operators will likely want to onboard devices from a large number of device manufacturers, with each manufacturer using a different root CA when issuing IDevIDs. If the number of different manufacturer root CAs is large, this could result in very large TLS handshake messages. Operators may prefer to include no CAs in the certificate_authorities field thus allowing devices to present IDevIDs signed by any CA when establishing the TEAP tunnel, and instead enforce policy at LDevID enrollment time.</p>
<p id="rfc.section.4.1.p.4">It is recommended that the client validate the certificate presented by the server in the server&#8217;s Certificate message, but this may not be possible for clients that have not yet provisioned appropriate trust anchors. If the client is in the provisioning phase and has not yet completed a BRSKI flow, it will not have trust anchors installed yet, and thus will not be able to validate the server&#8217;s certificate. The client must however note the certificate presented by the server for (i) inclusion in the BRSKI-RequestVoucher TLV and for (ii) validation once the client has discovered the local domain trust anchors.</p>
<p id="rfc.section.4.1.p.5">If the client does not present a suitable certificate to the server, the server MUST terminate the connection and fail the EAP request. If the TEAP server is unable to validate the client&#8217;s certificate using its implicit or explicit trust anchor database it MUST fail the EAP request.</p>
<p id="rfc.section.4.1.p.6">On establishment of the outer TLS tunnel, the TEAP server will make a policy decision on next steps. Possible policy decisions include:</p>
<p></p>

<ul>
<li>Option 1: Server grants client full network access and returns EAP-Success. This will typically happen when the client presents a valid LDevID. Network policy may grant client network access based on IDevID without requiring the device to enroll to obtain an LDevID.</li>
<li>Option 2: Server requires that client perform a full BRSKI flow, and then enroll to get an LDevID. This will typically happen when the client presents a valid IDevID and network policy requires all clients to have LDevIDs. The server sends a Request-Action TLV that includes a BRSKI-RequestVoucher TLV to the client to instruct it to start the BRSKI flow.</li>
<li>Option 3: Server requires that the client reenroll to obtain a new LDevID. This could happen when the client presents a valid LDevID that is very close to expiration time, or the server&#8217;s policy requires an LDevID update. The server sends an Action-Request TLV including a PKCS#10 TLV to the client to instruct it to reenroll.</li>
</ul>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#brski-trust-establishment" id="brski-trust-establishment">BRSKI Trust Establishment</a>
</h1>
<p id="rfc.section.4.2.p.1">If the server requires that client perform a full BRSKI flow, it sends a Request-Action TLV that includes a zero byte length BRSKI-RequestVoucher TLV to the client. The client sends a new BRSKI-RequestVoucher TLV to the server, which contains all data specified in <a href="#I-D.ietf-anima-bootstrapping-keyinfra" class="xref">[I-D.ietf-anima-bootstrapping-keyinfra]</a> section 5.2. The client includes the server certificate it received in the server&#8217;s Certificate message during outer TLS tunnel establishment in the proximity-registrar-cert field. The client signs the request using its IDevID.</p>
<p id="rfc.section.4.2.p.2">The server includes all additional information as required by <a href="#I-D.ietf-anima-bootstrapping-keyinfra" class="xref">[I-D.ietf-anima-bootstrapping-keyinfra]</a> section 5.4 and signs the request prior to forwarding to the MASA.</p>
<p id="rfc.section.4.2.p.3">The MASA responds as per <a href="#I-D.ietf-anima-bootstrapping-keyinfra" class="xref">[I-D.ietf-anima-bootstrapping-keyinfra]</a> section 5.5. The response may indicate failure and the server should react accordingly to failures by sending a failure response to the client, and failing the TEAP method.</p>
<p id="rfc.section.4.2.p.4">If the MASA replies with a signed voucher and a successful result, the server then forwards this response to the client in a BRSKI-Voucher TLV.</p>
<p id="rfc.section.4.2.p.5">When the client receives the signed voucher, it validates the signature using its built in trust anchor list, and extracts the pinned-domain-cert field. The client must use the CA included in the pinned-domain-cert to validate the certificate that was presented by the server when establishing the outer TLS tunnel. If this certificate validation fails, the client must fail the TEAP request and not connect to the network.</p>
<p id="rfc.section.4.2.p.6">[TBD- based on client responses, the registrar sends a status update to the MASA]</p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#certificate-expiration-times" id="certificate-expiration-times">Certificate Expiration Times</a>
</h1>
<p><a href="#IEEE8021AR" class="xref">[IEEE8021AR]</a> section 7.2.7.2 states:</p>
<p></p>

<ul class="empty"><li>notAfter: The latest time a DevID is expected to be used. Devices possessing an IDevID are expected to operate indefinitely into the future and should use the value 99991231235959Z. Solutions verifying a DevID are expected to accept this value indefinitely.</li></ul>
<p id="rfc.section.4.3.p.3">TEAP servers SHOULD follow the 802.1AR standard when validating IDevIDs.</p>
<p id="rfc.section.4.3.p.4">TEAP servers SHOULD reject LDevIDs with expired certificates and SHOULD NOT allow clients to connect with recently expired LDevIDs. If a client presents a recently expired LDevID it SHOULD be forced to authenticate using its IDevID and then reenroll to obtain a valid LDevID.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#channel-and-crypto-binding" id="channel-and-crypto-binding">Channel and Crypto Binding</a>
</h1>
<p id="rfc.section.5.p.1">As the TEAP BRSKI flow does not define or require an inner EAP method, there is no explicit need for exchange of Channel-Binding TLVs between the device and the TEAP server.</p>
<p id="rfc.section.5.p.2">The TEAP BRSKI TLVs are expected to occur at the beginning of the TEAP Phase 2 and MUST occur before the final Crypto-Binding TLV.  This draft does not exclude the possibility of having other EAP methods occur following the TEAP BRSKI TLVs and as such, the Crypto-Binding TLV process rules as defined in <a href="#RFC7170" class="xref">[RFC7170]</a> apply.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#protocol-flows" id="protocol-flows">Protocol Flows</a>
</h1>
<p id="rfc.section.6.p.1">This section outlines protocol flows that map to the three server policy options described in section <a href="#teap-tunnel-establishment" class="xref">Section 4.1</a>. The protocol flows illustrate a TLS1.2 exchange. Pertinent notes are outlined in the protocol flows.</p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#teap-server-grants-access" id="teap-server-grants-access">TEAP Server Grants Access</a>
</h1>
<p id="rfc.section.6.1.p.1">In this flow, the server grants access as server policy allows the client to access the network based on the identity certificate that the client presented. This means that either (i) the client has previously completed BRSKI and has presented a valid LDevID or (ii) the client presents an IDevID and network policy allows access based purely on IDevID.</p>
<div id="rfc.figure.1"></div>
<div id="flow-1"></div>
<pre>

                      +----------------+
+--------+            | Authenticator/ |    +------+
| Client |            |   TEAP-Server  |    | MASA |
+--------+            +----------------+    +------+
    |  EAP-Request/           |                |
    |   Type=Identity         |                |
    |&lt;------------------------|                |
    |                         |                |
    |  EAP-Response/          |                |
    |   Type=Identity         |                |
    |------------------------&gt;|                |
    |                         |                |
    |  EAP-Request/           |                |
    |   Type=TEAP,            |                |
    |   TEAP Start,           |                |
    |   Authority-ID TLV      |                |
    |&lt;------------------------|                |
    |                         |                |
    |  EAP-Response/          |                |
    |   Type=TEAP,            |                |
    |   TLS(ClientHello)      |                |
    |------------------------&gt;|                |
    |                         |                |
    |  EAP-Request/           |                |
    |   Type=TEAP,            |                |
    |   TLS(ServerHello,      |                |
 (1)|   Certificate,          |                |
    |   ServerKeyExchange,    |                |
 (2)|   CertificateRequest,   |                |
    |   ServerHelloDone)      |                |
    |&lt;------------------------|                |
    |                         |                |
    |  EAP-Response/          |                |
    |   Type=TEAP,            |                |
 (3)|   TLS(Certificate,      |                |
    |   ClientKeyExchange,    |                |
    |   CertificateVerify,    |                |
    |   ChangeCipherSpec,     |                |
    |   Finished)             |                |
    |------------------------&gt;|                |
    |                         |                |
    |  EAP-Request/           |                |
    |   Type=TEAP,            |                |
    |   TLS(ChangeCipherSpec, |                |
    |   Finished),            |                |
    |   {Crypto-Binding TLV,  |                |
    |   Result TLV=Success}   |                |
    |&lt;------------------------|                |
    |                         |                |
    |  EAP-Response/          |                |
    |   Type=TEAP,            |                |
    |   {Crypto-Binding TLV,  |                |
    |   Result TLV=Success}   |                |
    |------------------------&gt;|                |
    |                         |                |
    |  EAP-Success            |                |
    |&lt;------------------------|                |


</pre>
<p class="figure">Figure 1: TEAP Server Grants Access</p>
<p id="rfc.section.6.1.p.2">Notes:</p>
<p id="rfc.section.6.1.p.3">(1) If the client has completed the BRSKI flow and has locally significant trust anchors, it must validate the Certificate received from the server. If the client has not yet completed the BRSKI flow, then it provisionally accepts the server Certificate and must validate it later once BRSKI is complete.</p>
<p id="rfc.section.6.1.p.4">(2) The server may include certificate_authorities field in the CertificateRequest message in order to restrict the identity certificates that the device is allowed present.</p>
<p id="rfc.section.6.1.p.5">(3) The device will present its LDevID, if it has one, in preference to its IDevID, if allowed by server policy.</p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> <a href="#teap-server-instructs-client-to-perform-brski-flow" id="teap-server-instructs-client-to-perform-brski-flow">TEAP Server Instructs Client to Perform BRSKI Flow</a>
</h1>
<p id="rfc.section.6.2.p.1">In this flow, the server instructs the client to perform a BRSKI flow by exchanging TLVs once the outer TLS tunnel is established.</p>
<div id="rfc.figure.2"></div>
<div id="flow-2"></div>
<pre>
                          +----------------+
+--------+                | Authenticator/ |    +------+  +----+
| Client |                |   TEAP-Server  |    | MASA |  | CA |
+--------+                +----------------+    +------+  +----+
    |  EAP-Request/               |                |        |
    |   Type=Identity             |                |        |
    |&lt;----------------------------|                |        |
    |                             |                |        |
    |  EAP-Response/              |                |        |
    |   Type=Identity             |                |        |
    |----------------------------&gt;|                |        |
    |                             |                |        |
    |  EAP-Request/               |                |        |
    |   Type=TEAP,                |                |        |
    |   TEAP Start,               |                |        |
    |   Authority-ID TLV          |                |        |
    |&lt;----------------------------|                |        |
    |                             |                |        |
    |  EAP-Response/              |                |        |
    |   Type=TEAP,                |                |        |
    |   TLS(ClientHello)          |                |        |
    |----------------------------&gt;|                |        |
    |                             |                |        |
    |  EAP-Request/               |                |        |
    |   Type=TEAP,                |                |        |
    |   TLS(ServerHello,          |                |        |
 (1)|   Certificate,              |                |        |
    |   ServerKeyExchange,        |                |        |
    |   CertificateRequest,       |                |        |
    |   ServerHelloDone)          |                |        |
    |&lt;----------------------------|                |        |
    |                             |                |        |
    |  EAP-Response/              |                |        |
    |   Type=TEAP,                |                |        |
    |   TLS(Certificate           |                |        |
    |   ClientKeyExchange,        |                |        |
    |   CertificateVerify,        |                |        |
    |   ChangeCipherSpec,         |                |        |
    |   Finished)                 |                |        |
    |----------------------------&gt;|                |        |
    |                             |                |        |
    |  EAP-Request/               |                |        |
    |   Type=TEAP,                |                |        |
    |   TLS(ChangeCipherSpec,     |                |        |
    |   Finished),                |                |        |
    |   {Crypto-Binding TLV,      |                |        |
    |   Result TLV=Success}       |                |        |
    |&lt;----------------------------|                |        |
    |                             |                |        |
    |  EAP-Response/              |                |        |
    |   Type=TEAP,                |                |        |
    |   {Crypto-Binding TLV,      |                |        |
    |   Result TLV=Success}       |                |        |
    |----------------------------&gt;|                |        |
    |                             |                |        |
  ** At this stage the outer TLS tunnel is established ** 
  ** The following message exchanges are for BRSKI     **
    |                             |                |        |
    |  EAP-Request/               |                |        |
    |   Type=TEAP,                |                |        |
 (2)|   {Request-Action TLV:      |                |        |
    |     Status=Failure,         |                |        |
    |     Action=Process-TLV,     |                |        |
    |     TLV=Request-Voucher,    |                |        |
    |     TLV=Trusted-Server-Root,|                |        |
    |     TLV=CSR-Attributes,     |                |        |
    |     TLV=PKCS#10}            |                |        |
    |&lt;----------------------------|                |        |
    |                             |                |        |
    |  EAP-Response/              |                |        |
    |   Type=TEAP,                |                |        |
 (3)|   {Request-Voucher TLV}     |                |        |
    |----------------------------&gt;| RequestVoucher |        |
    |                             |---------------&gt;|        |
    |                             |    Voucher     |        |
    |                             |&lt;---------------|        |
    |  EAP-Request/               |                |        |
    |   Type=TEAP,                |                |        |
 (4)|   {Voucher TLV}             |                |        |
    |&lt;----------------------------|                |        |
    |                             |                |        |
    |  EAP-Response/              |                |        |
    |   Type=TEAP,                |                |        |
 (5)|   {Trusted-Server-Root TLV} |                |        |
    |----------------------------&gt;|                |        |
    |                             |                |        |
    |  EAP-Request/               |                |        |
    |   Type=TEAP,                |                |        |
    |   {Trusted-Server-Root TLV} |                |        |
    |&lt;----------------------------|                |        |
    |                             |                |        |
    |  EAP-Response/              |                |        |
    |   Type=TEAP,                |                |        |
    |   {CSR-Attributes TLV}      |                |        |
    |----------------------------&gt;|                |        |
    |                             |                |        |
    |  EAP-Request/               |                |        |
    |   Type=TEAP,                |                |        |
    |   {CSR-Attributes TLV}      |                |        |
    |&lt;----------------------------|                |        |
    |                             |                |        |
    |  EAP-Response/              |                |        |
    |   Type=TEAP,                |                |        |
    |   {PKCS#10 TLV}             |                |        |
    |----------------------------&gt;|                |        |
    |                             |   PKCS#10      |        |
    |  EAP-Request/               |--------------/ | \-----&gt;|
    |   Type=TEAP,                |                |        |
    |   {PKCS#7 TLV,              |   PKCS#7       |        |
 (6)|    Result TLV=Success}      |&lt;-------------/ | \------|
    |&lt;----------------------------|                |        |
    |                             |                |        |
    |  EAP-Response/              |                |        |
    |   Type=TEAP,                |                |        |
    |   {Result TLV=Success}      |                |        |
    |----------------------------&gt;|                |        |
    |                             |                |        |
    |  EAP-Success                |                |        |
    |&lt;----------------------------|                |        |



</pre>
<p class="figure">Figure 2: TEAP Server Instructs Client to Perform BRSKI Flow</p>
<p id="rfc.section.6.2.p.2">Notes:</p>
<p id="rfc.section.6.2.p.3">(1) If the client has not yet completed the BRSKI flow, then it provisionally accepts the server certificate and must validate it later once BRSKI is complete. The server validates the client certificate using its trust anchor database.</p>
<p id="rfc.section.6.2.p.4">(2) The server instructs the client to start the BRSKI flow by sending a Request-Action TLV that includes a BRSKI-RequestVoucher TLV. The server also instructs the client to request trust anchors, to request CSR Attrites, and to initiate a PKCS certificate enrolment. As outlined in <a href="#RFC7170" class="xref">[RFC7170]</a>, the Request-Action TLV is sent after the Crypto-Binding TLV and Result TLV exchange.</p>
<p id="rfc.section.6.2.p.5">(3) The client includes the certificate it received from the server in the RequestVoucher message.</p>
<p id="rfc.section.6.2.p.6">(4) Once the client receives and validates the voucher signed by the MASA, it must verify the certificate it previously received from the server.</p>
<p id="rfc.section.6.2.p.7">(5) As outlined in <a href="#RFC7170" class="xref">[RFC7170]</a>, the Trusted-Server-Root TLV is exchanged after the Crypto-Binding TLV exchange, and after the client has used the Voucher to authenticate the TEAP server identity. This is equivalent to section [todo] from <a href="#I-D.ietf-anima-bootstrapping-keyinfra" class="xref">[I-D.ietf-anima-bootstrapping-keyinfra]</a>.</p>
<p id="rfc.section.6.2.p.8">(6) There is no need for an additional Crypto-Binding TLV exchange as there is no inner EAP method. All BRSKI exchanges are simply TLVs exchanged inside the outer TLS tunnel.</p>
<h1 id="rfc.section.6.3">
<a href="#rfc.section.6.3">6.3.</a> <a href="#teap-server-instructs-client-to-reenroll" id="teap-server-instructs-client-to-reenroll">TEAP Server Instructs Client to Reenroll</a>
</h1>
<p id="rfc.section.6.3.p.1">In this flow, the server instructs the client to reenroll and get a new LDevID by exchanging TLVs once the outer TLS tunnel is established.</p>
<div id="rfc.figure.3"></div>
<div id="flow-3"></div>
<pre>
                      +----------------+
+--------+            | Authenticator/ |    +------+  +----+
| Client |            |   TEAP-Server  |    | MASA |  | CA |
+--------+            +----------------+    +------+  +----+
    |  EAP-Request/           |                |        |
    |   Type=Identity         |                |        |
    |&lt;------------------------|                |        |
    |                         |                |        |
    |  EAP-Response/          |                |        |
    |   Type=Identity         |                |        |
    |------------------------&gt;|                |        |
    |                         |                |        |
    |  EAP-Request/           |                |        |
    |   Type=TEAP,            |                |        |
    |   TEAP Start,           |                |        |
    |   Authority-ID TLV      |                |        |
    |&lt;------------------------|                |        |
    |                         |                |        |
    |  EAP-Response/          |                |        |
    |   Type=TEAP,            |                |        |
    |   TLS(ClientHello)      |                |        |
    |------------------------&gt;|                |        |
    |                         |                |        |
    |  EAP-Request/           |                |        |
    |   Type=TEAP,            |                |        |
    |   TLS(ServerHello,      |                |        |
    |   Certificate,          |                |        |
    |   ServerKeyExchange,    |                |        |
    |   CertificateRequest,   |                |        |
    |   ServerHelloDone)      |                |        |
    |&lt;------------------------|                |        |
    |                         |                |        |
    |  EAP-Response/          |                |        |
    |   Type=TEAP,            |                |        |
    |   TLS(Certificate,      |                |        |
    |   ClientKeyExchange,    |                |        |
    |   CertificateVerify,    |                |        |
    |   ChangeCipherSpec,     |                |        |
    |   Finished)             |                |        |
    |------------------------&gt;|                |        |
    |                         |                |        |
    |  EAP-Request/           |                |        |
    |   Type=TEAP,            |                |        |
    |   TLS(ChangeCipherSpec, |                |        |
    |   Finished),            |                |        |
    |   {Crypto-Binding TLV,  |                |        |
    |   Result TLV=Success}   |                |        |
    |&lt;------------------------|                |        |
    |                         |                |        |
    |  EAP-Response/          |                |        |
    |   Type=TEAP,            |                |        |
    |   {Crypto-Binding TLV,  |                |        |
    |   Result TLV=Success}   |                |        |
    |------------------------&gt;|                |        |
    |                         |                |        |
    |  EAP-Request/           |                |        |
    |   Type=TEAP,            |                |        |
 (1)|   {Request-Action TLV:  |                |        |
    |     Status=Failure,     |                |        |
    |     Action=Process-TLV, |                |        |
    |     TLV=PKCS#10}        |                |        |
    |&lt;------------------------|                |        |
    |                         |                |        |
    |  EAP-Response/          |                |        |
    |   Type=TEAP,            |                |        |
    |   {PKCS#10 TLV}         |                |        |
    |------------------------&gt;|                |        |
    |                         |   PKCS#10      |        |
    |  EAP-Request/           |--------------/ | \-----&gt;|
    |   Type=TEAP,            |                |        |
    |   {PKCS#7 TLV,          |   PKCS#7       |        |
    |    Result TLV=Success}  |&lt;-------------/ | \------|
    |&lt;------------------------|                |        |
    |                         |                |        |
    |  EAP-Response/          |                |        |
    |   Type=TEAP,            |                |        |
    |   {Result TLV=Success}  |                |        |
    |------------------------&gt;|                |        |
    |                         |                |        |
    |  EAP-Success            |                |        |
    |&lt;------------------------|                |        |

</pre>
<p class="figure">Figure 3: TEAP Server Instructs Client to Reenroll</p>
<p id="rfc.section.6.3.p.2">(1) The server instructs the client to reenroll by sending a Request-Action TLV that includes a PKCS#10 TLV.</p>
<h1 id="rfc.section.6.4">
<a href="#rfc.section.6.4">6.4.</a> <a href="#out-of-band-reenroll" id="out-of-band-reenroll">Out of Band Reenroll</a>
</h1>
<p id="rfc.section.6.4.p.1">This section shows how the device does a reenroll to refresh its LDEvID directly against the registrar outside the context of the TEAP tunnel.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#teap-tlv-formats" id="teap-tlv-formats">TEAP TLV Formats</a>
</h1>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> <a href="#brski-tlvs" id="brski-tlvs">BRSKI TLVs</a>
</h1>
<p id="rfc.section.7.1.p.1">BRSKI defines 3 new TEAP TLVs. The following table indicates whether the TLVs can be included in Request messages from TEAP server to device, or Response messages from device to TEAP server.</p>
<pre>
+------------------------+----------+
| TLV                    | Message  |
+------------------------+----------+
| BRSKI-VoucherRequest   | Response |
| BRSKI-Voucher          | Request  |
| CSR-Attributes         | Response |
+------------------------+----------+

</pre>
<p id="rfc.section.7.1.p.2">These new TLVs are detailed in this section.</p>
<h1 id="rfc.section.7.1.1">
<a href="#rfc.section.7.1.1">7.1.1.</a> <a href="#brski-requestvoucher-tlv" id="brski-requestvoucher-tlv">BRSKI-RequestVoucher TLV</a>
</h1>
<p id="rfc.section.7.1.1.p.1">This TLV is used by the server as part of a Request-Action TLV to request from the peer that it initiate a voucher request.  When used in this fashion, the length of this TLV will be set to zero. The Status field of the Request-Action TLV MUST be set to Failure.</p>
<p id="rfc.section.7.1.1.p.2">It is also used by the peer to initiate the voucher request.  When used in this fashion, the length of the TLV will be set to that of the voucher request, as encoded and described in Section 3.3 in <a href="#I-D.ietf-anima-bootstrapping-keyinfra" class="xref">[I-D.ietf-anima-bootstrapping-keyinfra]</a>.</p>
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |M|R| TLV=TBD1-VoucherRequest   |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                              Value...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p id="rfc.section.7.1.1.p.3">The M and R bits are always expected to be set to 0.</p>
<p id="rfc.section.7.1.1.p.4">The server is expected to forward the voucher request to the MASA, and then return a voucher in a BRSKI-Voucher TLV as described below.  If it is unable to do so, it returns an TEAP Error TLV with one of the defined errors or the following:</p>
<pre>
TBD2-MASA-Notavailable  MASA unavailable
TBD3-MASA-Refused       MASA refuses to sign the voucher

</pre>
<p id="rfc.section.7.1.1.p.5">The peer terminates the TEAP connection, but may retry at some later point.  The backoff mechanism for such retries should be appropriate for the device.  Retries MUST occur no more frequently than once every two (TBD) minutes.</p>
<h1 id="rfc.section.7.1.2">
<a href="#rfc.section.7.1.2">7.1.2.</a> <a href="#brski-voucher-tlv" id="brski-voucher-tlv">BRSKI-Voucher TLV</a>
</h1>
<p id="rfc.section.7.1.2.p.1">This TLV is transmitted from the server to the peer.  It contains a signed voucher, as describe in <a href="#RFC8366" class="xref">[RFC8366]</a>.</p>
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |M|R| TLV=TBD4-Voucher          |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                              Value...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p id="rfc.section.7.1.2.p.2">Upon receiving this TLV the peer will validate the signature of the voucher, using its pre-installed manufacturer trust anchor (LDevID).  It MUST also validate the certificate used by the server to establish the TLS connection.</p>
<p id="rfc.section.7.1.2.p.3">If successful, it installs the new trust anchor contained in the voucher.</p>
<p id="rfc.section.7.1.2.p.4">Otherwise, the peer transmits an TEAP error TLV with one of the following error messages:</p>
<pre>
TBD5-Invalid-Signature  The signature of the voucher signer is invalid
TBD6-Invalid-Voucher    The form or content of the voucher is not valid
TBD7-Invalid-TLS-Signer The certificate used for the TLS connection
                       could not be validated.

</pre>
<h1 id="rfc.section.7.1.3">
<a href="#rfc.section.7.1.3">7.1.3.</a> <a href="#csr-attributes-tlv" id="csr-attributes-tlv">CSR-Attributes TLV</a>
</h1>
<p id="rfc.section.7.1.3.p.1">The server SHALL transmit this TLV to the peer, either along with the BRSKI-Voucher TLV or at any time earlier in a communication.  The peer shall include attributes required by the server in any following CSR.  The value of this TLV is the base64 encoding described in Section 4.5.2 of <a href="#RFC7030" class="xref">[RFC7030]</a>.</p>
<pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |M|R| TLV=TBD8-CSR-Attributes |         length                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Value...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
<p id="rfc.section.7.1.3.p.2">Again, the M and R values are set to 0.  In the case where the client is unable to provide the requested attributes, an TEAP-Error is returned as follows:</p>
<p id="rfc.section.7.1.3.p.3">TBD9-CSR-Attribute-Fail Unable to supply the requested attributes.</p>
<h1 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> <a href="#existing-teap-tlv-specifications" id="existing-teap-tlv-specifications">Existing TEAP TLV Specifications</a>
</h1>
<p id="rfc.section.7.2.p.1">This section documents allowed usage of existing TEAP TLVs. The definition of the TLV is not changed, however clarifications on allowed values for the TLV fields is documented.</p>
<h1 id="rfc.section.7.2.1">
<a href="#rfc.section.7.2.1">7.2.1.</a> <a href="#pkcs10-tlv" id="pkcs10-tlv">PKCS#10 TLV</a>
</h1>
<p><a href="#RFC7170" class="xref">[RFC7170]</a> defines the PKCS#10 TLV as follows:</p>
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |M|R|         TLV Type          |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |           PKCS#10 Data...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-++-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-

</pre>
<p><a href="#RFC7170" class="xref">[RFC7170]</a> does not explicitly allow a Length value of zero.</p>
<p id="rfc.section.7.2.1.p.3">A Length value of zero is allowed for this TLV when the TEAP server sends a Request-Action TLV with a child PKCS#10 TLV to the client. In this scenario, there is no PKCS#10 Data included in the TLV. Clients MUST NOT send a zero length PKCS#10 TLV to the server.</p>
<h1 id="rfc.section.7.3">
<a href="#rfc.section.7.3">7.3.</a> <a href="#tlv-rules" id="tlv-rules">TLV Rules</a>
</h1>
<p id="rfc.section.7.3.p.1">BRSKI TLVs can only be transported inside the TLS tunnel. The following table provides a guide to which TLVs may be encapsulated in which kind of packets, and in what quantity. The messages are as follows: Request is a TEAP Request, Response is a TEAP Response, Success is a message containing a successful Result TLV, and Failure is a message containing a failed Result TLV.</p>
<p id="rfc.section.7.3.p.2">The following define the meaning of the table entries in the sections below:</p>
<p id="rfc.section.7.3.p.3">0   This TLV MUST NOT be present in the message.</p>
<p id="rfc.section.7.3.p.4">0+  Zero or more instances of this TLV MAY be present in the message.</p>
<p id="rfc.section.7.3.p.5">0-1 Zero or one instance of this TLV MAY be present in the message.</p>
<p id="rfc.section.7.3.p.6">1   Exactly one instance of this TLV MUST be present in the message.</p>
<p id="rfc.section.7.3.p.7">Request Response Success Failure TLVs 0       0-1      0       0       BRSKI-VoucherRequest 0-1     0        0       0       BRSKI-Voucher 0       0-1      0       0       CSR-Attributes</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#fragmentation" id="fragmentation">Fragmentation</a>
</h1>
<p id="rfc.section.8.p.1">TLS is expected to provide fragmentation support. Thus EAP-TEAP-BRSKI does not specifically provide any, as it is only expected to be used as an inner method to TEAP.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#iana-considerations" id="iana-considerations">IANA Considerations</a>
</h1>
<p id="rfc.section.9.p.1">The IANA is requested to add entries into the following tables:</p>
<p id="rfc.section.9.p.2">The following new TEAP TLVs are defined:</p>
<pre>
TBD1-VoucherRequest   Described in this document.
TBD4-Voucher          Described in this document.
TBD8-CSR-Attributes   Described in this document.

</pre>
<p id="rfc.section.9.p.3">The following TEAP Error Codes are defined, with their meanings listed here and in previous sections:</p>
<pre>
TBD2-MASA-Notavailable  MASA unavailable
TBD3-MASA-Refused       MASA refuses to sign the voucher
TBD5-Invalid-Signature  The signature of the voucher signer is invalid
TBD6-Invalid-Voucher    The form or content of the voucher is not valid
TBD7-Invalid-TLS-Signer The certificate used for the TLS connection
                        could not be validated.
TBD9-CSR-Attribute-Fail Unable to supply the requested attributes.

</pre>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a>
</h1>
<p id="rfc.section.10.p.1">BRSKI <a href="#I-D.ietf-anima-bootstrapping-keyinfra" class="xref">[I-D.ietf-anima-bootstrapping-keyinfra]</a> provides a zero touch way for devices to enroll in a certification authority (CA). It assumes the device has IP connectivity. For networks that will not grant IP connectivitiy before authenticating (with a local credential) this poses a Catch-22&#8211; can&#8217;t get on the network without a credential and can&#8217;t get a credential without getting on the network.</p>
<p id="rfc.section.10.p.2">This protocol provides a way for BRSKI to be in an EAP method which allows the BRSKI conversation to happen as part of EAP authentication and prior to obtaining IP connectivity.</p>
<p id="rfc.section.10.p.3">The  security considerations of <a href="#I-D.ietf-anima-bootstrapping-keyinfra" class="xref">[I-D.ietf-anima-bootstrapping-keyinfra]</a> apply to this protocol. Running BRSKI through EAP introduces some additional areas of concern though.</p>
<h1 id="rfc.section.10.1">
<a href="#rfc.section.10.1">10.1.</a> <a href="#issues-with-provisionally-authenticated-teap" id="issues-with-provisionally-authenticated-teap">Issues with Provisionally Authenticated TEAP</a>
</h1>
<p id="rfc.section.10.1.p.1">This protocol establishes an unauthenticated TLS connection and passes data through it. Provided that the only messages passed in this state are self-protected BRSKI messages this does not present a problem.  Passing any other messages or TLVs prior to authentication of the provisional TLS connection could potentially introduce security issues.</p>
<p id="rfc.section.10.1.p.2">While the TLS connection is unauthenticated, it must still be validated to the fullest extent possible. It is critical that the device and the TEAP server perform all steps in TLS&#8211; checking the validity of the presented certificate, validating the signature using the public key of the certificate, etc&#8211; except ensuring the trust of the presented certificate.</p>
<h1 id="rfc.section.10.2">
<a href="#rfc.section.10.2">10.2.</a> <a href="#attack-against-discovery" id="attack-against-discovery">Attack Against Discovery</a>
</h1>
<p id="rfc.section.10.2.p.1">The device discovery technique specified in this protocol is the standard EAP server discovery process. Since it is trivial to set up an 802.11 wireless access point and advertise any network, an attacker can impersonate a legitimate wireless network and attract unprovisioned pledges. Given that an unprovisioned device will not know the legitimate network to connect to, it will probably attempt the first network it finds, making the attack that much easier. This allows for a &#8220;rogue registrar&#8221; to provision and take control of the device.</p>
<p id="rfc.section.10.2.p.2">If the MASA verifies ownership prior to issuance of a voucher, this attack can be thwarted. But if the MASA is in reduced security mode and does not verify ownership this attack cannot be prevented. Registrars SHOULD use the audit log of a MASA when deploying newly purchased equipment in order to mitigate this attack.</p>
<p id="rfc.section.10.2.p.3">Another way to mitigate this attack is through normal &#8220;rogue AP&#8221; detection and prevention.</p>
<h1 id="rfc.section.10.3">
<a href="#rfc.section.10.3">10.3.</a> <a href="#teap-server-as-registration-authority" id="teap-server-as-registration-authority">TEAP Server as Registration Authority</a>
</h1>
<p id="rfc.section.10.3.p.1">If the TEAP server is logically separate from the Certification Authority (CA) (see <a href="#arch" class="xref">Section 2</a>) it will be acting as a Registration Authority (RA) when it obtains the PKCS#10 TLV and replies with a PKCS#7 TLV (see <a href="#RFC7170" class="xref">[RFC7170]</a>, Sections 4.2.16 and 4.2.17, respectively). The assurance a RA makes to a CA is that the public key in the presented CSR is bound to an authenticated identity in way that will assure non-repudiation.</p>
<p id="rfc.section.10.3.p.2">To make such an assurance, the TEAP server MUST authenticate the provisional TLS connection with the device by validating the voucher response received from the MASA. In addition, it is RECOMMENDED that the TEAP server indicate that proof-of-possession (see <a href="#RFC7170" class="xref">[RFC7170]</a>, Section 3.8.2) is required by including the challengePassword OID in the CSR Attributes TLV.</p>
<h1 id="rfc.section.10.4">
<a href="#rfc.section.10.4">10.4.</a> <a href="#trust-of-registrar" id="trust-of-registrar">Trust of Registrar</a>
</h1>
<p id="rfc.section.10.4.p.1">The device accepts a trusted server (CA) certificate and installs it in its trust anchor database during step 5 (see <a href="#bint" class="xref">Section 3.1</a>). This can happen only after the provisional TLS connection has been authenticated using the voucher and the Crypto-Binding TLV has been validated.</p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> <a href="#acknowledgments" id="acknowledgments">Acknowledgments</a>
</h1>
<p id="rfc.section.11.p.1">The authors would like to thank Brian Weis for his assistance, and Alan Dakok for improving language consistency.  In addition, with ruthlessly &#8220;borrowed&#8221; the concept around NAI handling from Tuomas Aura and Mohit Sethi.</p>
<h1 id="rfc.references">
<a href="#rfc.references">12.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-anima-bootstrapping-keyinfra">[I-D.ietf-anima-bootstrapping-keyinfra]</b></td>
<td class="top">
<a>Pritikin, M.</a>, <a>Richardson, M.</a>, <a>Behringer, M.</a>, <a>Bjarnason, S.</a> and <a>K. Watsen</a>, "<a href="https://tools.ietf.org/html/draft-ietf-anima-bootstrapping-keyinfra-22">Bootstrapping Remote Secure Key Infrastructures (BRSKI)</a>", Internet-Draft draft-ietf-anima-bootstrapping-keyinfra-22, June 2019.</td>
</tr>
<tr>
<td class="reference"><b id="IEEE8021AR">[IEEE8021AR]</b></td>
<td class="top">
<a>Institute for Electrical and Electronics Engineers</a>, "<a>Secure Device Identity</a>", 1998.</td>
</tr>
<tr>
<td class="reference"><b id="IEEE8021X">[IEEE8021X]</b></td>
<td class="top">
<a>Institute for Electrical and Electronics Engineers</a>, "<a>IEEE Standard for Local and metropolitan area networks--Port-Based Network Access Control</a>", 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3748">[RFC3748]</b></td>
<td class="top">
<a>Aboba, B.</a>, <a>Blunk, L.</a>, <a>Vollbrecht, J.</a>, <a>Carlson, J.</a> and <a>H. Levkowetz</a>, "<a href="https://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>", RFC 3748, DOI 10.17487/RFC3748, June 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7030">[RFC7030]</b></td>
<td class="top">
<a>Pritikin, M.</a>, <a>Yee, P.</a> and <a>D. Harkins</a>, "<a href="https://tools.ietf.org/html/rfc7030">Enrollment over Secure Transport</a>", RFC 7030, DOI 10.17487/RFC7030, October 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7170">[RFC7170]</b></td>
<td class="top">
<a>Zhou, H.</a>, <a>Cam-Winget, N.</a>, <a>Salowey, J.</a> and <a>S. Hanna</a>, "<a href="https://tools.ietf.org/html/rfc7170">Tunnel Extensible Authentication Protocol (TEAP) Version 1</a>", RFC 7170, DOI 10.17487/RFC7170, May 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8366">[RFC8366]</b></td>
<td class="top">
<a>Watsen, K.</a>, <a>Richardson, M.</a>, <a>Pritikin, M.</a> and <a>T. Eckert</a>, "<a href="https://tools.ietf.org/html/rfc8366">A Voucher Artifact for Bootstrapping Protocols</a>", RFC 8366, DOI 10.17487/RFC8366, May 2018.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.A">
<a href="#rfc.appendix.A">Appendix A.</a> <a href="#changes-from-earlier-versions" id="changes-from-earlier-versions">Changes from Earlier Versions</a>
</h1>
<p id="rfc.section.A.p.1">Draft -03: * Merge EAP server and Registrar * Security considerations * References improvements * Add Dan Harkins as co-author</p>
<p id="rfc.section.A.p.2">Draft -02: * Flow corrections</p>
<p id="rfc.section.A.p.3">Draft -01: * Add packet descriptions, IANA considerations, smooth out language.</p>
<p id="rfc.section.A.p.4">Draft -00:</p>
<p></p>

<ul><li>Initial revision</li></ul>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Eliot Lear</span> 
	  <span class="n hidden">
		<span class="family-name">Lear</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span class="vcardline">Richtistrasse 7</span>

	  <span class="vcardline">
		<span class="locality">Wallisellen</span>,  
		<span class="region"></span>
		<span class="code">CH-8304</span>
	  </span>
	  <span class="country-name vcardline">Switzerland</span>
	</span>
	<span class="vcardline">Phone: +41 44 878 9200</span>

<span class="vcardline">EMail: <a href="mailto:lear@cisco.com">lear@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Owen Friel</span> 
	  <span class="n hidden">
		<span class="family-name">Friel</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span class="vcardline">170 W. Tasman Dr.</span>

	  <span class="vcardline">
		<span class="locality">San Jose, CA</span>,  
		<span class="region"></span>
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">United States</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ofriel@cisco.com">ofriel@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Nancy Cam-Winget</span> 
	  <span class="n hidden">
		<span class="family-name">Cam-Winget</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span class="vcardline">170 W. Tasman Dr.</span>

	  <span class="vcardline">
		<span class="locality">San Jose, CA</span>,  
		<span class="region"></span>
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">United States</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ncamwing@cisco.com">ncamwing@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Dan harkins</span> 
	  <span class="n hidden">
		<span class="family-name">Harkins</span>
	  </span>
	</span>
	<span class="org vcardline">HP Enterprise</span>
	<span class="adr">
	  <span class="vcardline">3333 Scott Boulevard</span>

	  <span class="vcardline">
		<span class="locality">Santa Clara, CA</span>,  
		<span class="region"></span>
		<span class="code">95054</span>
	  </span>
	  <span class="country-name vcardline">United States</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:dharkins@arubanetworks.com">dharkins@arubanetworks.com</a></span>

  </address>
</div>

</body>
</html>
